<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        x:Class="AvaloniaTests.Views.ResultsListWindow"
        x:DataType="vm:ResultsListViewModel"
        xmlns:vm="clr-namespace:AvaloniaTests.ViewModels"
        Width="950"
        Height="650"
        WindowStartupLocation="CenterOwner"
        Icon="C:\Users\nozdr\source\repos\TestsAvaloniaMVVM\AvaloniaTests\Assets\Pudje.jpg"
        Title="Результаты тестов"
        Background="#FFF5E6CC"
        Foreground="Black"
        FontFamily="Segoe UI,avares://Avalonia.Fonts.Inter/Assets#Inter">

    <ScrollViewer>
        <StackPanel Margin="20" Spacing="15">
            
            <TextBlock Text="Результаты прохождения тестов" 
                       FontSize="24" 
                       FontWeight="Bold" 
                       HorizontalAlignment="Center" />

            <Border Background="LightYellow" Padding="10" CornerRadius="5">
                <StackPanel>
                    <TextBlock Text="{Binding ResultsCount, StringFormat='Найдено результатов: {0}', FallbackValue='Найдено результатов: 0'}" 
                               FontWeight="Bold" HorizontalAlignment="Center"/>
                    
                    <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Margin="0,5,0,0">
                        <TextBlock Text="Debug: Results.Count = " />
                        <TextBlock Text="{Binding Results.Count, FallbackValue='NULL'}" FontWeight="Bold" />
                        <TextBlock Text=", ResultsCount = " Margin="10,0,0,0" />
                        <TextBlock Text="{Binding ResultsCount, FallbackValue='NULL'}" FontWeight="Bold" />
                    </StackPanel>
                </StackPanel>
            </Border>

            <Border Background="White" BorderBrush="Gray" BorderThickness="1" CornerRadius="5" Padding="10">
                <StackPanel>
                    <TextBlock Text="Список результатов:" FontWeight="Bold" Margin="0,0,0,10"/>
                    
                    <ItemsControl ItemsSource="{Binding Results}">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate x:DataType="vm:TestResultDisplayItem">
                                <Border Background="LightBlue" Margin="0,2" Padding="10,5" CornerRadius="3">
                                    <StackPanel Orientation="Horizontal" Spacing="15">
                                        <TextBlock Text="👤" />
                                        <TextBlock Text="{Binding UserName}" FontWeight="Bold" MinWidth="80"/>
                                        <TextBlock Text="📝" />
                                        <TextBlock Text="{Binding TestTitle}" MinWidth="120"/>
                                        <TextBlock Text="🎯" />
                                        <TextBlock Text="{Binding Score}" MinWidth="50"/>
                                        <TextBlock Text="📅" />
                                        <TextBlock Text="{Binding CompletionDate}" MinWidth="100"/>
                                        
                                        <Button Content="👁️ Подробно" 
                                                Command="{Binding $parent[ItemsControl].((vm:ResultsListViewModel)DataContext).ViewResultCommand}"
                                                CommandParameter="{Binding}"
                                                Background="#FF4CAF50"
                                                Foreground="White"
                                                Padding="5,2"
                                                FontSize="10"
                                                Margin="10,0,0,0"/>
                                        
                                        <Button Content="🗑️ Удалить" 
                                                Command="{Binding $parent[ItemsControl].((vm:ResultsListViewModel)DataContext).DeleteResultCommand}"
                                                CommandParameter="{Binding}"
                                                Background="#FFF44336"
                                                Foreground="White"
                                                Padding="5,2"
                                                FontSize="10"/>
                                    </StackPanel>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                    
                    <TextBlock Text="Результаты не найдены" 
                               HorizontalAlignment="Center" 
                               Margin="20"
                               FontStyle="Italic"
                               Name="NoResultsMessage"/>
                </StackPanel>
            </Border>

            <Border Background="LightCoral" Padding="10" CornerRadius="5">
                <StackPanel>
                    <TextBlock Text="Тест статических данных:" FontWeight="Bold" Margin="0,0,0,10"/>
                    <TextBlock Text="Пользователь: nozdr, Тест: Test 1, Результат: 3/3" />
                    <TextBlock Text="Пользователь: nozdr, Тест: Test 2, Результат: 1/1" />
                    <TextBlock Text="Пользователь: nozdr, Тест: Test 3, Результат: 1/1" />
                </StackPanel>
            </Border>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" Spacing="10">
                <Button Content="Обновить" 
                        Command="{Binding RefreshCommand}"
                        Background="#FF2196F3"
                        Foreground="White"
                        Padding="20,10"
                        FontSize="14"/>
                
                <Button Content="Закрыть" 
                        Command="{Binding CloseCommand}"
                        Background="#FF757575"
                        Foreground="White"
                        Padding="20,10"
                        FontSize="14"/>
            </StackPanel>

        </StackPanel>
    </ScrollViewer>
</Window>